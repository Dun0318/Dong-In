<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mbc.pdi_05_01.company.CompanyService">
<insert id="companyinsert">insert into company0327 values(company0327_seq.nextval,#{param1},#{param2},#{param3},#{param4},#{param5})</insert>
<select id="companyselect" resultType="com.mbc.pdi_05_01.company.CompanyDTO">select snumber,name,
(case when substr(jumin,8,1)in('1','3')then'남자'when substr(jumin,8,1)in('2','4')then'여자'end) as sexuality,
trunc(months_between(sysdate,day)/12)+1 as inday,
(decode(trunc(months_between(sysdate,day)/12)+1,1,1500000,2,2000000,3,2500000,4,3000000,5,3500000,4000000)) as kibonsudang,
(decode(family,'1명',500000,'2명',700000,'3명',900000,1100000)) as familysudang,
(case when rank='사원'then 1000000 when rank='대리'then 2000000 when rank='과장'then 3000000 when rank='부장'then 4000000 end) as ranksudang,
((decode(trunc(months_between(sysdate,day)/12)+1,1,1500000,2,2000000,3,2500000,4,3000000,5,3500000,4000000))+
(decode(family,'1명',500000,'2명',700000,'3명',900000,1100000))+
(case when rank='사원'then 1000000 when rank='대리'then 2000000 when rank='과장'then 3000000 when rank='부장'then 4000000 end)) as totalSalary,
to_number(to_char(sysdate,'yyyy'))-to_number((case when substr(jumin,8,1)in('1','2')then '19' when substr(jumin,8,1)in('3','4')then'20' end || substr(jumin,1,2))) as age
from company0327 order by snumber asc
</select>

<select id="updateselect" resultType="com.mbc.pdi_05_01.company.CompanyDTO">select * from company0327 where snumber=#{param1}</select>

<update id="companyupdatego">update company0327 set name=#{param1},jumin=#{param2},day=#{param3},family=#{param4},rank=#{param5} where snumber=#{param6}</update>
<delete id="deletego">delete from company0327 where snumber=#{param1}</delete>
<select id="companysearchgo" resultType="com.mbc.pdi_05_01.company.CompanyDTO"> select snumber,name,jumin,day,family,rank,
(case when substr(jumin,8,1)in('1','3')then'남자'when substr(jumin,8,1)in('2','4')then'여자'end) as sexuality,
trunc(months_between(sysdate,day)/12)+1 as inday,
(decode(trunc(months_between(sysdate,day)/12)+1,1,1500000,2,2000000,3,2500000,4,3000000,5,3500000,4000000)) as kibonsudang,
(decode(family,'1명',500000,'2명',700000,'3명',900000,1100000)) as familysudang,
(case when rank='사원'then 1000000 when rank='대리'then 2000000 when rank='과장'then 3000000 when rank='부장'then 4000000 end) as ranksudang,
((decode(trunc(months_between(sysdate,day)/12)+1,1,1500000,2,2000000,3,2500000,4,3000000,5,3500000,4000000))+
(decode(family,'1명',500000,'2명',700000,'3명',900000,1100000))+
(case when rank='사원'then 1000000 when rank='대리'then 2000000 when rank='과장'then 3000000 when rank='부장'then 4000000 end)) as totalSalary,
to_number(to_char(sysdate,'yyyy'))-to_number((case when substr(jumin,8,1)in('1','2')then '19' when substr(jumin,8,1)in('3','4')then'20' end || substr(jumin,1,2))) as age
from company0327
<where>
	<choose>
		<when test="param1== 'snumber'">
		snumber like '%' || #{param2} || '%'
		</when>
		<when test="param1== 'name'">
		name like '%' || #{param2} || '%'
		</when>
	</choose>
</where>
</select>
</mapper>
